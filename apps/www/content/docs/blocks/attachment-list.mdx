---
title: Attachment List
description: Composed attachment list with cards for chat/file scenarios
author: AF
---

<ComponentPreview
  name="attachment-list-demo"
  description="Attachment list with normal and loading states"
  className="mb-4"
/>

Attachment List 是组合组件，提供附件卡片与横向滚动列表的默认布局，适用于聊天输入区、消息附件展示等场景。需要深度定制时可使用 primitives。

## Installation

<CodeTabs>

<TabsList>
  <TabsTrigger value="cli">CLI</TabsTrigger>
  <TabsTrigger value="manual">Manual</TabsTrigger>
</TabsList>

<TabsContent value="cli">

```bash
npx shadcn@latest add http://localhost:3000/r/wuhan/attachment-list.json
```

</TabsContent>

<TabsContent value="manual">

<Steps>

<Step>Copy and paste the following code into your project.</Step>

<ComponentSource
  name="attachment-list"
  title="registry/wuhan/composed/attachment-list/attachment-list.tsx"
/>

<Step>Update the import paths to match your project setup.</Step>

</Steps>

</TabsContent>

</CodeTabs>

## Overview

- **定位**：附件卡片列表（图片/文件统一展示）
- **默认样式**：默认卡片 + 删除按钮 + 横向滚动
- **扩展能力**：支持业务数据适配与插槽渲染

## Usage

### 基础用法（直接 items）

```tsx
import { AttachmentListComposed } from "@/registry/wuhan/composed/attachment-list/attachment-list";

const items = [
  { id: "1", name: "design.png", isImage: true, thumbnail: "..." },
  { id: "2", name: "spec.pdf", fileType: "PDF", fileSize: "1.2MB" },
];

<AttachmentListComposed items={items} onRemove={(id) => console.log(id)} />;
```

### AttachmentItem 结构

`AttachmentItem` 是组件消费的**标准化数据结构**，如果你不想自己拼它，可以改用 `attachments + attachmentAdapter`。

```ts
type AttachmentItem = {
  id: string;
  name?: string;
  fileType?: string;
  fileSize?: string;
  thumbnail?: string;
  previewUrl?: string;
  url?: string;
  loading?: boolean;
  isImage?: boolean;
  icon?: React.ReactNode;
  onClick?: () => void;
};
```

### 数据适配（推荐）

```tsx
const attachments = [
  { key: "1", filename: "design.png", sizeLabel: "1.8MB", kind: "image" },
];

<AttachmentListComposed
  attachments={attachments}
  // 适配函数：把你的业务数据转换成组件认识的 AttachmentItem
  attachmentAdapter={(item) => ({
    id: item.key,
    name: item.filename,
    fileSize: item.sizeLabel,
    isImage: item.kind === "image",
  })}
/>;
```

#### 为什么需要 attachments + attachmentAdapter

- 你的业务数据结构通常不是 `AttachmentItem`（字段名、结构不同）
- 通过 `attachmentAdapter`，你**不需要改数据结构**，只需要做一次映射
- 这样组件保持“通用”，业务保持“独立”

#### 最小可运行示例（带注释）

```tsx
const attachments = [
  { key: "1", filename: "design.png", sizeLabel: "1.8MB", kind: "image" },
];

<AttachmentListComposed
  // 原始业务数据
  attachments={attachments}
  // 把业务数据转成 AttachmentItem
  attachmentAdapter={(item) => ({
    id: item.key,                 // 必填：唯一 id
    name: item.filename,          // 可选：展示的文件名
    fileSize: item.sizeLabel,     // 可选：展示的文件大小
    isImage: item.kind === "image", // 可选：是否是图片
  })}
/>;
```

### 插槽渲染（高级）

```tsx
<AttachmentListComposed
  items={items}
  renderMeta={({ meta }) => <span className="text-xs text-muted-foreground">{meta}</span>}
  renderDelete={({ onRemove }) => (
    <button onClick={onRemove} className="text-xs">删除</button>
  )}
/>;
```

### 预览能力（图片/文件）

```tsx
<AttachmentListComposed
  items={[
    {
      id: "img-1",
      name: "preview.png",
      thumbnail: "https://placehold.co/56x56",
      previewUrl: "https://placehold.co/600x400",
      isImage: true,
    },
    {
      id: "file-1",
      name: "spec.pdf",
      fileType: "PDF",
      fileSize: "1.2MB",
      url: "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf",
    },
  ]}
  previewEnabled
/>;
```

## Examples

### Default

包含图片附件、文件附件，以及上传中的 loading 状态（图片区域居中显示 20px 圆环）。

<ComponentPreview
  name="attachment-list-demo"
  description="Default attachment list"
  className="mb-4"
/>

### Preview

点击卡片即可预览图片或文件。

<ComponentPreview
  name="attachment-list-preview"
  description="Preview images and files"
  className="mb-4"
/>

### Custom Render

自定义 Meta 与删除按钮。

<ComponentPreview
  name="attachment-list-custom-render"
  description="Custom meta and delete button"
  className="mb-4"
/>

### Empty State

空列表占位。

<ComponentPreview
  name="attachment-list-empty"
  description="Empty state"
  className="mb-4"
/>

## API (Composed)

### 数据与适配

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `items` | `AttachmentItem[]` | - | 直接传 UI 结构数据。 |
| `attachments` | `T[]` | - | 业务数据数组，配合 `attachmentAdapter`。 |
| `attachmentAdapter` | `(item) => AttachmentItem` | - | 业务数据转 UI 数据。 |

### 事件

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `onRemove` | `(id, item?) => void` | - | 删除回调。 |
| `onItemClick` | `(item) => void` | - | 点击卡片回调。 |
| `onItemSelect` | `(item) => void` | - | 选择卡片回调。 |

### 渲染与插槽

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `renderItem` | `(ctx) => ReactNode` | - | 覆盖整张卡片渲染。 |
| `renderLeading` | `(ctx) => ReactNode` | - | 覆盖图标/缩略图区域。 |
| `renderContent` | `(ctx) => ReactNode` | - | 覆盖标题与 meta 区域。 |
| `renderMeta` | `(ctx) => ReactNode` | - | 覆盖 meta 文本。 |
| `renderThumbnail` | `(ctx) => ReactNode` | - | 覆盖图片缩略图渲染。 |
| `renderDelete` | `(ctx) => ReactNode` | - | 覆盖删除按钮。 |
| `renderEmpty` | `() => ReactNode` | - | 列表为空时的占位内容。 |

### 计算逻辑

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `getItemMeta` | `(item) => ReactNode` | - | 自定义 meta 计算。 |
| `getItemIsImage` | `(item) => boolean` | - | 自定义图片判定。 |
| `getItemIcon` | `(item) => ReactNode` | - | 自定义默认图标。 |

### 预览

| 属性 | 类型 | 默认值 | 说明 |
|------|------|--------|------|
| `previewEnabled` | `boolean` | `false` | 启用内置预览弹层。 |
| `previewOnClick` | `boolean` | `true` | 点击卡片时打开预览。 |
| `previewItem` | `AttachmentItem \| null` | - | 受控预览项。 |
| `onPreviewChange` | `(item \| null) => void` | - | 预览项变更回调。 |
| `renderPreview` | `(item) => ReactNode` | - | 自定义预览内容。 |
| `renderPreviewTitle` | `(item) => ReactNode` | - | 自定义预览标题。 |
| `getItemPreviewable` | `(item) => boolean` | - | 自定义“是否可预览”。 |

## Behavior Notes

- 同时传 `items` 与 `attachments` 时优先使用 `items`。
- 使用 `renderItem` 时，其它局部插槽不会生效。
- 内置预览默认支持：图片（`previewUrl/thumbnail`）和文件 iframe（`url`）。

